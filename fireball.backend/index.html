<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fireball AI - Machine Learning Game</title>
    <meta name="description" content="Challenge a Q-Learning AI in this strategic battle game. Outthink the machine!">
    
    <!-- Nunito Sans - Professional variant of Nunito -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,opsz,wght@0,6..12,300;0,6..12,400;0,6..12,500;0,6..12,600;0,6..12,700;0,6..12,800;1,6..12,400&display=swap" rel="stylesheet">
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* ============================================
           FIREBALL DESIGN SYSTEM
           Fire gradients (red/orange/yellow) + cool accents (purple/indigo/blue)
           ============================================ */
        
        :root {
            /* Fire gradient colors */
            --fire-red: #dc2626;
            --fire-orange: #ea580c;
            --fire-amber: #f59e0b;
            --fire-yellow: #fbbf24;
            
            /* Cool accent colors */
            --accent-purple: #7c3aed;
            --accent-indigo: #4f46e5;
            --accent-blue: #2563eb;
            --accent-violet: #8b5cf6;
            
            /* Backgrounds */
            --bg-primary: #0c0a14;
            --bg-secondary: #14101f;
            --bg-card: #1a1528;
            --bg-card-hover: #221d32;
            
            /* Text */
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            
            /* Borders */
            --border-subtle: rgba(255, 255, 255, 0.08);
            --border-accent: rgba(234, 88, 12, 0.4);
            
            /* Shadows */
            --glow-fire: 0 0 30px rgba(234, 88, 12, 0.3), 0 0 60px rgba(220, 38, 38, 0.15);
            --glow-purple: 0 0 30px rgba(124, 58, 237, 0.3), 0 0 60px rgba(79, 70, 229, 0.15);
            
            /* Gradients */
            --gradient-fire: linear-gradient(135deg, var(--fire-red), var(--fire-orange), var(--fire-amber));
            --gradient-fire-soft: linear-gradient(135deg, rgba(220, 38, 38, 0.15), rgba(234, 88, 12, 0.1), rgba(245, 158, 11, 0.05));
            --gradient-cool: linear-gradient(135deg, var(--accent-purple), var(--accent-indigo), var(--accent-blue));
            --gradient-cool-soft: linear-gradient(135deg, rgba(124, 58, 237, 0.15), rgba(79, 70, 229, 0.1), rgba(37, 99, 235, 0.05));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            background-image: 
                radial-gradient(ellipse at 20% 0%, rgba(124, 58, 237, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(234, 88, 12, 0.06) 0%, transparent 50%);
        }

        /* ============================================
           TYPOGRAPHY
           ============================================ */
        
        h1, h2, h3 {
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        h1 {
            font-size: 2.25rem;
        }

        h2 {
            font-size: 1.5rem;
        }

        h3 {
            font-size: 1.125rem;
        }

        /* ============================================
           LAYOUT
           ============================================ */
        
        .app-container {
            min-height: 100vh;
            width: 100%;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .content-wrapper {
            width: 100%;
            max-width: 800px;
        }

        /* ============================================
           HEADER
           ============================================ */
        
        .header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .logo-container {
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient-fire);
            border-radius: 12px;
            box-shadow: var(--glow-fire);
        }

        .logo-icon {
            font-size: 1.75rem;
            filter: brightness(1.2);
        }

        .header-text h1 {
            background: var(--gradient-fire);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-text p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.125rem;
        }

        /* ============================================
           NAVIGATION
           ============================================ */
        
        .nav-container {
            display: flex;
            gap: 0.5rem;
            padding: 0.375rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .nav-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 0.9375rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .nav-button:hover {
            background: var(--bg-card);
            color: var(--text-primary);
        }

        .nav-button.active {
            background: var(--gradient-cool);
            color: white;
            box-shadow: var(--glow-purple);
        }

        .nav-button .icon {
            font-size: 1.125rem;
        }

        /* ============================================
           CARDS
           ============================================ */
        
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.2s ease;
        }

        .card-header {
            margin-bottom: 1.5rem;
        }

        .card-header h2 {
            margin-bottom: 0.25rem;
        }

        .card-header p {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* ============================================
           CHARGE DISPLAY
           ============================================ */
        
        .charge-display {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            gap: 1.5rem;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .charge-block {
            text-align: center;
        }

        .charge-block.player .charge-label {
            color: var(--fire-orange);
        }

        .charge-block.opponent .charge-label {
            color: var(--accent-violet);
        }

        .charge-label {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .charge-value {
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 1;
        }

        .charge-divider {
            width: 1px;
            height: 60px;
            background: var(--border-subtle);
        }

        .vs-badge {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* ============================================
           MOVE BUTTONS
           ============================================ */
        
        .moves-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }

        .move-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1.5rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9375rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .move-button:hover:not(:disabled) {
            transform: translateY(-2px);
            border-color: var(--border-accent);
        }

        .move-button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .move-button .move-icon {
            font-size: 2rem;
        }

        /* Move-specific colors */
        .move-button.charge {
            --move-color: #facc15;
        }
        .move-button.charge:hover:not(:disabled) {
            background: rgba(250, 204, 21, 0.1);
            box-shadow: 0 0 20px rgba(250, 204, 21, 0.2);
        }

        .move-button.shield {
            --move-color: #60a5fa;
        }
        .move-button.shield:hover:not(:disabled) {
            background: rgba(96, 165, 250, 0.1);
            box-shadow: 0 0 20px rgba(96, 165, 250, 0.2);
        }

        .move-button.fireball {
            --move-color: #ef4444;
        }
        .move-button.fireball:hover:not(:disabled) {
            background: rgba(239, 68, 68, 0.1);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.2);
        }

        .move-button.iceball {
            --move-color: #22d3ee;
        }
        .move-button.iceball:hover:not(:disabled) {
            background: rgba(34, 211, 238, 0.1);
            box-shadow: 0 0 20px rgba(34, 211, 238, 0.2);
        }

        .move-button.megaball {
            --move-color: #a855f7;
        }
        .move-button.megaball:hover:not(:disabled) {
            background: rgba(168, 85, 247, 0.1);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.2);
        }

        .move-button .move-icon {
            filter: drop-shadow(0 0 8px var(--move-color));
        }

        /* ============================================
           BUTTONS
           ============================================ */
        
        .btn-primary {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: var(--gradient-fire);
            border: none;
            border-radius: 10px;
            color: white;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: var(--glow-fire);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            filter: brightness(1.1);
        }

        .btn-secondary {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-secondary:hover {
            background: var(--bg-card-hover);
            border-color: var(--border-accent);
        }

        /* ============================================
           HISTORY
           ============================================ */
        
        .history-container {
            margin-top: 2rem;
        }

        .history-container h3 {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-height: 280px;
            overflow-y: auto;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 12px;
        }

        .history-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.875rem 1rem;
            background: var(--bg-card);
            border-radius: 8px;
        }

        .history-moves {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            font-size: 0.875rem;
        }

        .history-moves .player-move {
            color: var(--fire-orange);
        }

        .history-moves .ai-move {
            color: var(--accent-violet);
        }

        .history-result {
            font-size: 0.8125rem;
            font-weight: 600;
            padding: 0.375rem 0.75rem;
            background: var(--bg-secondary);
            border-radius: 6px;
            color: var(--text-secondary);
        }

        /* ============================================
           ALERTS & MESSAGES
           ============================================ */
        
        .alert {
            padding: 1rem 1.25rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            font-size: 0.9375rem;
        }

        .alert-error {
            background: rgba(220, 38, 38, 0.15);
            border: 1px solid rgba(220, 38, 38, 0.3);
            color: #fca5a5;
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.15);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #fcd34d;
        }

        .alert-title {
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        /* ============================================
           END GAME
           ============================================ */
        
        .end-game {
            text-align: center;
            padding: 2rem;
        }

        .end-game-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
        }

        .end-game-title.win {
            background: var(--gradient-fire);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .end-game-title.lose {
            color: var(--text-secondary);
        }

        /* ============================================
           STATS PAGE
           ============================================ */
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            padding: 1.25rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
        }

        .stat-card .stat-label {
            font-size: 0.8125rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-card .stat-value {
            font-size: 2rem;
            font-weight: 800;
        }

        .recent-matches {
            margin-top: 1.5rem;
        }

        .match-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 10px;
            margin-bottom: 0.75rem;
        }

        .match-winner {
            font-weight: 700;
            color: var(--fire-orange);
        }

        .match-details {
            font-size: 0.8125rem;
            color: var(--text-muted);
        }

        /* ============================================
           1V1 PAGE
           ============================================ */
        
        .coming-soon-badge {
            display: inline-block;
            padding: 0.375rem 0.75rem;
            background: var(--gradient-cool);
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-left: 0.75rem;
        }

        .input-field {
            width: 100%;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-violet);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.15);
        }

        .input-field:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ============================================
           LOADER
           ============================================ */
        
        .loader {
            width: 40px;
            height: 40px;
            border: 3px solid var(--bg-card);
            border-top-color: var(--fire-orange);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loader-container {
            display: flex;
            justify-content: center;
            padding: 2rem;
        }

        /* ============================================
           RESPONSIVE
           ============================================ */
        
        @media (max-width: 640px) {
            .header h1 {
                font-size: 1.75rem;
            }

            .nav-container {
                flex-wrap: wrap;
            }

            .nav-button {
                flex: 1;
                justify-content: center;
                padding: 0.625rem 0.75rem;
                font-size: 0.8125rem;
            }

            .nav-button span:not(.icon) {
                display: none;
            }

            .charge-display {
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
            }

            .charge-divider {
                display: none;
            }

            .charge-value {
                font-size: 2.5rem;
            }

            .moves-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .move-button {
                padding: 1rem 0.75rem;
            }

            .move-button .move-icon {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { createRoot } = ReactDOM;

        // Move icons with emoji
        const MOVE_ICONS = {
            charge: "âš¡",
            shield: "ðŸ›¡ï¸",
            fireball: "ðŸ”¥",
            iceball: "â„ï¸",
            megaball: "ðŸ’¥"
        };

        const NAV_ICONS = {
            playAI: "ðŸ§ ",
            play1v1: "âš”ï¸",
            stats: "ðŸ“Š"
        };

        const GameLogic = {
            getLegalMoves: (charges) => {
                const moves = ["charge", "shield"];
                if (charges >= 1) moves.push("fireball");
                if (charges >= 2) moves.push("iceball");
                if (charges >= 5) moves.push("megaball");
                return moves;
            }
        };

        function Header() {
            return (
                <header className="header">
                    <div className="logo-container">
                        <span className="logo-icon">ðŸ”¥</span>
                    </div>
                    <div className="header-text">
                        <h1>Fireball AI</h1>
                        <p>Q-Learning Machine Intelligence</p>
                    </div>
                </header>
            );
        }

        function NavButton({ icon, label, isActive, onClick }) {
            return (
                <button
                    onClick={onClick}
                    className={`nav-button ${isActive ? 'active' : ''}`}
                >
                    <span className="icon">{icon}</span>
                    <span>{label}</span>
                </button>
            );
        }

        function ChargeDisplay({ playerCharges, oppCharges, p1Label = "Your", p2Label = "AI" }) {
            return (
                <div className="charge-display">
                    <div className="charge-block player">
                        <div className="charge-label">{p1Label} Charges</div>
                        <div className="charge-value">{playerCharges}</div>
                    </div>
                    <div className="charge-divider">
                        <span className="vs-badge">VS</span>
                    </div>
                    <div className="charge-block opponent">
                        <div className="charge-label">{p2Label} Charges</div>
                        <div className="charge-value">{oppCharges}</div>
                    </div>
                </div>
            );
        }

        function MoveSelector({ legalMoves, onMoveSelect, disabled }) {
            const allMoves = ["charge", "shield", "fireball", "iceball", "megaball"];

            return (
                <div className="moves-grid">
                    {allMoves.map(move => {
                        const isLegal = legalMoves.includes(move);
                        return (
                            <button
                                key={move}
                                onClick={() => isLegal && onMoveSelect(move)}
                                disabled={disabled || !isLegal}
                                className={`move-button ${move}`}
                            >
                                <span className="move-icon">{MOVE_ICONS[move]}</span>
                                <span>{move.charAt(0).toUpperCase() + move.slice(1)}</span>
                            </button>
                        );
                    })}
                </div>
            );
        }

        function EndGameDisplay({ winner, onPlayAgain }) {
            const isPlayerWin = winner === 'player1' || winner === 'human';
            
            return (
                <div className="end-game">
                    <h2 className={`end-game-title ${isPlayerWin ? 'win' : 'lose'}`}>
                        {isPlayerWin ? "Victory! ðŸŽ‰" : "Defeated ðŸ˜”"}
                    </h2>
                    <p style={{ color: 'var(--text-secondary)', marginBottom: '1.5rem' }}>
                        {isPlayerWin 
                            ? "You outplayed the machine learning model!" 
                            : "The AI predicted your strategy. Try again!"}
                    </p>
                    <button onClick={onPlayAgain} className="btn-primary">
                        Play Again
                    </button>
                </div>
            );
        }

        function HistoryDisplay({ history }) {
            if (history.length === 0) return null;
            
            return (
                <div className="history-container">
                    <h3>Turn History</h3>
                    <div className="history-list">
                        {history.map((turn, i) => (
                            <div key={i} className="history-item">
                                <div className="history-moves">
                                    <span className="player-move">You: {turn.player}</span>
                                    <span className="ai-move">AI: {turn.ai}</span>
                                </div>
                                <span className="history-result">{turn.result}</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function PlayAIPage() {
            const [game, setGame] = useState({ playerCharges: 0, aiCharges: 0, gameOver: false, winner: null });
            const [history, setHistory] = useState([]);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);

            const legalMoves = GameLogic.getLegalMoves(game.playerCharges);

            const handlePlayMove = async (move) => {
                setLoading(true);
                setError(null);
                
                try {
                    const response = await fetch('/api/play_ai', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            playerMove: move,
                            playerCharges: game.playerCharges,
                            aiCharges: game.aiCharges,
                            moveHistory: history.map(h => h.player),
                            oppMoveHistory: history.map(h => h.ai),
                        }),
                    });

                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    
                    const data = await response.json();
                    
                    setGame({
                        playerCharges: data.playerCharges,
                        aiCharges: data.aiCharges,
                        gameOver: data.gameOver,
                        winner: data.winner
                    });
                    
                    setHistory([
                        { player: move, ai: data.aiMove, result: data.result },
                        ...history
                    ]);

                } catch (err) {
                    setError('Failed to connect to AI backend. Please ensure the API is deployed.');
                    console.error(err);
                }
                setLoading(false);
            };

            const handlePlayAgain = () => {
                setGame({ playerCharges: 0, aiCharges: 0, gameOver: false, winner: null });
                setHistory([]);
                setError(null);
            };

            return (
                <div className="card">
                    <div className="card-header">
                        <h2>Challenge the AI</h2>
                        <p>Outthink the Q-Learning model to win</p>
                    </div>
                    
                    <ChargeDisplay playerCharges={game.playerCharges} oppCharges={game.aiCharges} />
                    
                    {error && (
                        <div className="alert alert-error">
                            <div className="alert-title">Connection Error</div>
                            <div>{error}</div>
                        </div>
                    )}
                    
                    {game.gameOver ? (
                        <EndGameDisplay winner={game.winner} onPlayAgain={handlePlayAgain} />
                    ) : (
                        <MoveSelector
                            legalMoves={legalMoves}
                            onMoveSelect={handlePlayMove}
                            disabled={loading}
                        />
                    )}
                    
                    {loading && (
                        <div className="loader-container">
                            <div className="loader"></div>
                        </div>
                    )}
                    
                    <HistoryDisplay history={history} />
                </div>
            );
        }

        function Play1v1Page() {
            const [username, setUsername] = useState("");
            
            return (
                <div className="card">
                    <div className="card-header">
                        <h2>
                            1v1 Battle
                            <span className="coming-soon-badge">Coming Soon</span>
                        </h2>
                        <p>Real-time matches against other players</p>
                    </div>
                    
                    <div className="alert alert-warning">
                        <div className="alert-title">Under Development</div>
                        <div>Real-time matchmaking is being rebuilt for Vercel deployment.</div>
                    </div>
                    
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem', opacity: 0.5 }}>
                        <input
                            type="text"
                            value={username}
                            onChange={(e) => setUsername(e.target.value)}
                            placeholder="Enter your username"
                            disabled
                            className="input-field"
                        />
                        <button disabled className="btn-secondary" style={{ width: '100%', opacity: 0.5 }}>
                            Find Match
                        </button>
                    </div>
                </div>
            );
        }

        function StatCard({ label, value }) {
            return (
                <div className="stat-card">
                    <div className="stat-label">{label}</div>
                    <div className="stat-value">{value}</div>
                </div>
            );
        }

        function StatsPage() {
            const [stats, setStats] = useState(null);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                const fetchStats = async () => {
                    setLoading(true);
                    setError(null);
                    try {
                        const response = await fetch('/api/stats');
                        if (!response.ok) throw new Error('Failed to fetch stats');
                        const data = await response.json();
                        setStats(data);
                    } catch (err) {
                        setError("Stats backend not connected. Showing placeholder data.");
                        setStats({
                            uniqueVisitors: 0,
                            aiWinRate: 0,
                            aiGames: 0,
                            avgMatchLength: 0,
                            recentMatches: []
                        });
                    }
                    setLoading(false);
                };
                
                fetchStats();
            }, []);

            if (loading) {
                return (
                    <div className="card">
                        <div className="loader-container">
                            <div className="loader"></div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="card">
                    <div className="card-header">
                        <h2>Live Statistics</h2>
                        <p>Real-time game metrics and performance</p>
                    </div>
                    
                    {error && (
                        <div className="alert alert-warning">
                            <div>{error}</div>
                        </div>
                    )}
                    
                    <div className="stats-grid">
                        <StatCard label="Unique Visitors" value={stats.uniqueVisitors} />
                        <StatCard label="AI Win Rate" value={`${stats.aiWinRate}%`} />
                        <StatCard label="Avg. Match" value={`${stats.avgMatchLength} rounds`} />
                    </div>
                    
                    <div className="recent-matches">
                        <h3 style={{ marginBottom: '1rem' }}>Recent Matches</h3>
                        {stats.recentMatches.length > 0 ? (
                            <div>
                                {stats.recentMatches.map((match, i) => (
                                    <div key={i} className="match-item">
                                        <div>
                                            <span className="match-winner">{match.winner}</span>
                                            <span style={{ color: 'var(--text-secondary)', marginLeft: '0.5rem' }}>
                                                won in {match.rounds} rounds
                                            </span>
                                        </div>
                                        <span className="match-details">{match.p1} vs {match.p2}</span>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <p style={{ color: 'var(--text-muted)' }}>No matches recorded yet. Be the first!</p>
                        )}
                    </div>
                </div>
            );
        }

        function App() {
            const [page, setPage] = useState("playAI");

            return (
                <div className="app-container">
                    <div className="content-wrapper">
                        <Header />
                        
                        <nav className="nav-container">
                            <NavButton
                                icon={NAV_ICONS.playAI}
                                label="Play vs AI"
                                isActive={page === "playAI"}
                                onClick={() => setPage("playAI")}
                            />
                            <NavButton
                                icon={NAV_ICONS.play1v1}
                                label="1v1 Battle"
                                isActive={page === "play1v1"}
                                onClick={() => setPage("play1v1")}
                            />
                            <NavButton
                                icon={NAV_ICONS.stats}
                                label="Stats"
                                isActive={page === "stats"}
                                onClick={() => setPage("stats")}
                            />
                        </nav>

                        <main>
                            {page === "playAI" && <PlayAIPage />}
                            {page === "play1v1" && <Play1v1Page />}
                            {page === "stats" && <StatsPage />}
                        </main>
                    </div>
                </div>
            );
        }

        // Mount the app
        try {
            const root = createRoot(document.getElementById('root'));
            root.render(<App />);
        } catch (error) {
            console.error("Error mounting app:", error);
            document.getElementById('root').innerHTML = '<div style="color: white; padding: 20px;">Error loading app. Check console.</div>';
        }
    </script>
</body>
</html>